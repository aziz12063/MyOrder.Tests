@page "/CreateBasket"

@using Fluxor
@using Microsoft.AspNetCore.WebUtilities
@using MyOrder.Store.CreateBasketUseCase

@inject NavigationManager navigationManager
@inject IDispatcher dispatcher



@rendermode InteractiveServer

@code {

    protected override void OnInitialized()
    {
        // Parse the query string parameters
        var uri = navigationManager.ToAbsoluteUri(navigationManager.Uri);
        var queryParams = QueryHelpers.ParseQuery(uri.Query);

        var basketRequestDto = new NewBasketRequestDto();

        foreach (var param in queryParams)
        {
            switch (param.Key.ToLower())
            {
                case "basketid":
                    basketRequestDto.BasketId = param.Value;
                    break;
                case "contactid":
                    basketRequestDto.ContactId = param.Value;
                    break;
                case "accountid":
                    basketRequestDto.AccountId = param.Value;
                    break;
                case "salesid":
                    basketRequestDto.SalesId = param.Value;
                    break;
                case "quotationid":
                    basketRequestDto.QuotationId = param.Value;
                    break;
                case "invoiceid":
                    basketRequestDto.InvoiceId = param.Value;
                    break;
                case "apisalesid":
                    basketRequestDto.ApiSalesId = param.Value;
                    break;
                case "orderid":
                    basketRequestDto.OrderId = param.Value;
                    break;
                case "casenumber":
                    basketRequestDto.CaseNumber = param.Value;
                    break;
                case "savtype":
                    basketRequestDto.SavType = param.Value;
                    break;
                case "fsrequestid":
                    basketRequestDto.FsRequestId = param.Value;
                    break;
            }
        }

        dispatcher.Dispatch(new CreateBasketAction(basketRequestDto));

    }
}
