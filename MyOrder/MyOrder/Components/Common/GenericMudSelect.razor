@using MyOrder.Shared.Dtos.SharedComponents
@typeparam T

@if (!IsHidden)
{
    <MudSelect T="T"
               Typo="Typo.body2"
               Style="margin-inline:0;"
               Class="@Class"
               Label="@Field?.Name"
               Margin="Margin.Dense"
               Dense="true"
               Variant="@Variant"
               FullWidth="true"
               AnchorOrigin="Origin.CenterCenter"
               Required="@IsRequired"
               ReadOnly="@IsReadOnly"
               Disabled="@IsReadOnly"
               @bind-Value="BoundValue"
               @bind-Value:after="BoundValueChangedHandler">
        @if (Items is not null)
        {
            foreach (var item in Items)
            {
                <MudSelectItem T="T" Value="@item" />
            }
        }
    </MudSelect>
}

@code {
    [Parameter, EditorRequired] public T? BoundValue { get; set; }
    [Parameter, EditorRequired] public Field<T>? Field { get; set; }
    [Parameter, EditorRequired] public List<T>? Items { get; set; }
    [Parameter] public Variant Variant { get; set; } = 0;
    [Parameter] public string? Class { get; set; }
    [Parameter] public EventCallback<T> BoundValueChanged { get; set; }

    private async Task BoundValueChangedHandler() => await BoundValueChanged.InvokeAsync(BoundValue);

    private bool IsHidden => FieldUtility.IsHidden(Field);
    private bool IsReadOnly => FieldUtility.IsReadOnly(Field);
    private bool IsRequired => FieldUtility.IsRequired(Field);
    private bool IsDisabled => FieldUtility.IsDisabled(Field);
}