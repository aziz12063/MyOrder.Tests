@using MyOrder.Shared.Dtos.SharedComponents
@typeparam T

@if (Field != null && !FieldUtility.IsHidden(Field))
{
    <MudTooltip RootStyle="width:100%"
                Text="@TooltipText"
                Placement="Placement.Top">

        <MudField Margin="Margin.Dense"
                  Variant="Variant.Outlined"
                  FullWidth="true"
                  InnerPadding="false"
                  Class="@CssClass"
                  Label="@Field?.Name">
            <MudText Typo="Typo.body2">
                @if (Field!.Value is List<string> stringList && stringList is { Count: > 0 })
                {
                    for (var i = 0; i < stringList.Count - 2; i++)
                    {
                        var x = i;
                        @stringList[x]
                        <br />
                    }

                    if (stringList.Count > 1)
                    {
                        @stringList[stringList.Count - 2]
                        <br />
                        @stringList[^1]
                    }
                    else
                    {
                        @stringList[^1]
                    }
                }
                else
                {
                    @FieldUtility.NullOrWhiteSpaceHelperWithDash(Field.Value?.ToString())
                }
            </MudText>
        </MudField>
    </MudTooltip>
}

@code {
    [Parameter, EditorRequired]
    public Field<T>? Field { get; set; }

    private string CssClass { get; set; } = "outlined-display-field";
    private string? TooltipText => Field?.Description ?? Field?.Name;

    protected override void OnParametersSet()
    {
        CssClass = Field!.DisplayStyle switch
        {
            FieldDisplayStyle.Emphasize => string.Concat(
                CssClass, " ", "onlyfordisplay-field-emphasize"),
            FieldDisplayStyle.Warn => string.Concat(
                CssClass, " ", "onlyfordisplay-field-warn"),
            _ => CssClass
        };
    }
}
