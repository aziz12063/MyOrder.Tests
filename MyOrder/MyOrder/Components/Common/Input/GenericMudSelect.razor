@using MyOrder.Shared.Dtos.SharedComponents
@typeparam T
@inherits GenericInputBase<T>

@if (Field != null && !hidden)
{
    <MudTooltip RootStyle="width:100%"
                Text="@_tooltipText"
                Placement="Placement.Top">
        <MudSelect T="T"
                   Typo="Typo.body2"
                   Class="@Class"
                   Label="@Field?.Name"
                   Margin="Margin.Dense"
                   Dense="true"
                   Variant="@Variant"
                   FullWidth="true"
                   AnchorOrigin="Origin.CenterCenter"
                   Required="required"
                   Error="required"
                   ReadOnly="readOnly"
                   Disabled="readOnly"
                   @bind-Value="BoundValue"
                   @bind-Value:after="BoundValueChangedHandler">
            @if (Items is not null)
            {
                foreach (var item in Items)
                {
                    <MudSelectItem T="T" Value="@item" />
                }
            }
        </MudSelect>
    </MudTooltip>
}

@code {
    private const string OUTLINED_CSS_CLASS = "outlined-generic-select";

    [Parameter, EditorRequired] public List<T>? Items { get; set; }
    [Parameter] public Variant Variant { get; set; } = 0;
    [Parameter] public string? Class { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();

        if (Variant == Variant.Outlined)
        {
            if (string.IsNullOrEmpty(Class))
                Class = OUTLINED_CSS_CLASS;
            else
                Class += OUTLINED_CSS_CLASS;
        }
    }

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        if (BoundValue is BasketValueDto basketValueDto)
            _tooltipText = "test";
    }
    private string? _tooltipText;

}