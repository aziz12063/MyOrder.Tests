@using MyOrder.Store.GeneralInfoUseCase

@inherits FluxorComponentBase<BlockingReasonsState, FetchBlockingReasonsAction>

<FetchActionTypeCascadingValue FetchActionTypeValue="FetchActionType">
    <MudDialog TitleClass="pb-2"
               ContentClass="px-2 pb-2">
        <TitleContent>
            <MudText Typo="Typo.h5">Raisons de blocage</MudText>
        </TitleContent>
        <DialogContent>
            <MudDataGrid Items="BlockingReasons"
                         Bordered="true"
                         Dense="true"
                         Striped="true"
                         SortMode="SortMode.None"
                         Elevation="0"
                         Outlined="false"
                         FixedHeader="true"
                         Height="30vh"
                         Loading="!Initialized || IsLoading">
                <Columns>
                    <PropertyColumn Title="Code"
                                    Property="item => item.ReasonId.Value" />

                    <PropertyColumn Title="Description"
                                    Property="item => item.Description.Value" />

                    <TemplateColumn Title="Active">
                        <CellTemplate>
                            <GenericCheckBox Field="context.Item.IsActive"
                                             HideLabel="true" />
                        </CellTemplate>
                    </TemplateColumn>

                    <PropertyColumn Title="Commentaires"
                                    Property="item => item.Comment.Value" />

                </Columns>
                <NoRecordsContent>
                    @if (!Initialized || IsLoading)
                    {
                        <MudText Class="pt-5 pb-10"
                                 Typo="Typo.body1">Chargement des raisons de blocage</MudText>
                    }
                    else if (IsFaulted)
                    {
                        <MudText Class="pt-5 pb-10"
                                 Typo="Typo.body1"
                                 Color="Color.Error">Erreur lors du chargement des raisons de blocage<br />@ErrorMessage</MudText>
                    }
                    else
                    {
                        <MudText Class="pt-5 pb-10"
                                 Typo="Typo.body1">Aucune raison de blocage n'est disponible.</MudText>
                    }
                </NoRecordsContent>
            </MudDataGrid>
        </DialogContent>
    </MudDialog>
</FetchActionTypeCascadingValue>