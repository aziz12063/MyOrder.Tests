@using MyOrder.Store.TradeInfoUseCase
@inherits MyOrder.Components.Common.BaseFluxorComponent<TradeInfoState, FetchTradeInfoAction>

@if (State.Value.IsLoading)
{
    <HeaderElementLoadingSkeleton />
    return;
}

<MudContainer Class="pa-0">
    <MudStack Spacing="4">
        <MudText Typo="Typo.h6" Color="Color.Secondary">Commercial info</MudText>
        <MudStack Spacing="2">
            <MudText Typo="Typo.subtitle1" >@BasketTradeInfoDto?.Turnover?.Name</MudText>
            <MudDataGrid Items="@Turnover" Filterable="false" SortMode="@SortMode.None" Groupable="false" Dense="true">
                <Columns >
                    <PropertyColumn Property="x => x.Name" />
                    <PropertyColumn Property="x => x.Ytd" />
                    <PropertyColumn Property="x => x.YtdN1" />
                    <PropertyColumn Property="x => x.N1" />
                    <PropertyColumn Property="x => x.N2" />
                </Columns>
            </MudDataGrid>
        </MudStack>
       
        <!--Contract en cours-->
        @if (ContractList.Count > 0)
        {
            <MudStack Spacing="0">
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">
                    Contrats en cours
                </MudText>

                <!--Contract dataGrid-->
                <MudDataGrid Items="@ContractList"
                             Filterable="false"
                             SortMode="@SortMode.None"
                             Groupable="false"
                             Bordered="true"
                             Dense="true"
                             Class="my-data-grid">
                    <Columns>
                        <TemplateColumn Width="40px">
                            <CellTemplate>
                                <MudIconButton Icon="@Icons.Material.Filled.ArrowForward" Color="Color.Primary" />
                            </CellTemplate>
                        </TemplateColumn>
                        <PropertyColumn Property="x => x.ContractId.Value " Title="@BasketTradeInfoDto?.Contract?.ContractId?.Name" />
                        <PropertyColumn Property="x => x.ContractGroup.Name" Title="@BasketTradeInfoDto?.Contract?.ContractGroup?.Name" />
                        <PropertyColumn Property="x => x.Status.Value" Title="@BasketTradeInfoDto?.Contract?.Status?.Name" />

                    </Columns>
                </MudDataGrid>

            </MudStack>
            <!--Contract en cours details if it's not null-->
            <MudStack Spacing="0">
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">@ContractDescription</MudText>
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">@Contract.ContractId.Value</MudText>
                <!--Contract details-->
                <MudGrid >
                    <MudItem xs="4" >
                        <MudText Style="font-size: 13px">Date</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@DateValue">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">@BasketTradeInfoDto?.Contract?.CampaignId?.Name</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@CampaignIdValue">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">@BasketTradeInfoDto?.Contract?.MainContact?.Name</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@MainContactValue">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">@BasketTradeInfoDto?.Contract?.OfficeExecutive?.Name</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@OfficeExecutiveValue">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudText>Détail des remises</MudText>
                <MudGrid>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Lines="2"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px;"
                                      Value="DiscountDetails">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
            </MudStack>
        }

        else
        {
            <MudStack Spacing="0">
                <MudText Typo="Typo.body2" Style="color:black; font-family: Arial; font-size: 12px">Contrats en cours</MudText>
                <MudText Typo="Typo.body2">Aucune contrat en cours</MudText>
            </MudStack>
        }

    </MudStack>
</MudContainer>
