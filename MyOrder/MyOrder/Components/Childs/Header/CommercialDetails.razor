@using MyOrder.Store.TradeInfoUseCase
@inherits BaseFluxorComponent<TradeInfoState, FetchTradeInfoAction>

@if (State.Value.IsLoading)
{
    <HeaderElementLoadingSkeleton />
    return;
}

<MudContainer Class="pa-0">
    <MudStack Spacing="4">
        <MudText Typo="Typo.h6" Color="Color.Secondary">Commercial info</MudText>
        <MudStack Spacing="2">
            <MudText Typo="Typo.body2" Color="Color.Secondary">ChiffreD'Affaire</MudText>
            <MudDataGrid Items="@Turnover" Filterable="false" SortMode="@SortMode.None" Groupable="false" Dense="true">
                <Columns >
                    <PropertyColumn Property="x => x.Name" />
                    <PropertyColumn Property="x => x.Ytd" />
                    <PropertyColumn Property="x => x.YtdN1" />
                    <PropertyColumn Property="x => x.N1" />
                    <PropertyColumn Property="x => x.N2" />
                </Columns>
            </MudDataGrid>
        </MudStack>
        <MudGrid Spacing="0">
            <MudItem xs="12">
                <MudText Typo="Typo.body2" Color="Color.Secondary">Secteur d'activité</MudText>
            </MudItem>
            <MudItem xs="12">
                <MudTextField Typo="Typo.caption"
                              Lines="2"
                              Variant="Variant.Text"
                              FullWidth="true"
                              Margin="Margin.Dense"
                              ReadOnly="true"
                              Value="string.Empty" />
            </MudItem>
        </MudGrid>
        <!--Contract en cours-->
        @if (ContractList.Count > 0)
        {
            <MudStack Spacing="0">
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">
                    Contrats en cours
                </MudText>

                <!--Contract dataGrid-->
                <MudDataGrid Items="@ContractList"
                             Filterable="false"
                             SortMode="@SortMode.None"
                             Groupable="false"
                             Bordered="true"
                             Dense="true"
                             Class="my-data-grid">
                    <Columns>
                        <TemplateColumn Width="40px">
                            <CellTemplate>
                                <MudIconButton Icon="@Icons.Material.Filled.ArrowForward" Color="Color.Primary" />
                            </CellTemplate>
                        </TemplateColumn>
                        <PropertyColumn Property="x => x.ContractId.Value" Title="Contrat" />
                        <PropertyColumn Property="x => x.ContractGroup.Name" Title="Groupe de contrat" />
                        <PropertyColumn Property="x => x.Status.Value" Title="Statut" />

                    </Columns>
                </MudDataGrid>

            </MudStack>
            <!--Contract en cours details if it's not null-->
            <MudStack Spacing="0">
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">@ContractDescription</MudText>
                <MudText Typo="Typo.h6"
                         Style="color:red;
                                font-family: Arial;
                                font-size: 18px;
                                font-weight: bold">@Contract.ContractId.Value</MudText>
                <!--Contract details-->
                <MudGrid >
                    <MudItem xs="4" >
                        <MudText Style="font-size: 13px">Date</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@(BasketTradeInfoDto != null &&
                                           Contract != null &&
                                           Contract.StartDate != null &&
                                           Contract.EndDate != null &&
                                           Contract.StartDate.Value != null &&
                                           Contract.EndDate.Value != null ?
                                           DateValue : "")">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">Campagne de prix</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@(BasketTradeInfoDto != null &&
                                           Contract != null &&
                                           Contract.CampaignId != null &&
                                           Contract.CampaignId.Value != null ?
                                           Contract.CampaignId.Value : "")">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">Commercial terrain</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@(BasketTradeInfoDto != null &&
                                           Contract != null &&
                                           Contract.MainContact != null &&
                                           Contract.MainContact.Value != null ?
                                           Contract.MainContact.Value : "")">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudGrid>
                    <MudItem xs="4">
                        <MudText Style="font-size: 13px">Commercial sédentaire</MudText>
                    </MudItem>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px; height:22px;"
                                      Value="@(BasketTradeInfoDto != null &&
                                           Contract != null &&
                                           Contract.OfficeExecutive != null &&
                                           Contract.OfficeExecutive.Value != null ?
                                           Contract.OfficeExecutive.Value : "")">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
                <MudText>Détail des remises</MudText>
                <MudGrid>
                    <MudItem xs="8">
                        <MudTextField Margin="Margin.Dense" T="string"
                                      Lines="2"
                                      Variant="Variant.Outlined" Width="200px"
                                      Disabled="false"
                                      Style="font-size: 13px;"
                                      Value="DiscountListValue">
                        </MudTextField>
                    </MudItem>
                </MudGrid>
            </MudStack>
        }

        else
        {
            <MudStack Spacing="0">
                <MudText Typo="Typo.body2" Style="color:black; font-family: Arial; font-size: 12px">Contrats en cours</MudText>
                <MudText Typo="Typo.body2">Aucune contrat en cours</MudText>
            </MudStack>
        }

    </MudStack>
</MudContainer>
