@using MyOrder.Store.PricesInfoUseCase
@using System.Globalization
@inherits MyOrder.Components.Common.BaseFluxorComponent<PricesInfoState, FetchPricesInfoAction>

@if (isLoading)
{
    <PricesAndLinesElementLoadingSkeleton />
    return;
}

<MudText Typo="Typo.h6" Color="Color.Secondary" Class="pa-3">Totaux et prix</MudText>

<MudGrid Class="pa-4" Justify="Justify.SpaceBetween">
    <!--Column1-->
    <MudItem xs="3">
        <MudStack Justify="Justify.SpaceBetween">
            <!--1-->
            <GenericMudSelect T="string"
                              Variant="Variant.Outlined"
                              @bind-BoundValue="@CouponValue"
                              Field="BasketPricesInfo!.Coupon"
                              Items="Coupons?.Select(item => item?.Value).ToList()" />

            <!--2-->
            <DisplayField Field="BasketPricesInfo!.FreeShippingAmountThreshold" />

            <!--3-->
            <DisplayField Field="BasketPricesInfo!.GiftAmountThreshold" />

            <!--4-->
            <DisplayField Field="BasketPricesInfo!.ProductsInfo" />

        </MudStack>
    </MudItem>

    <!--Column2-->
    <MudItem xs="3">
        <MudStack Justify="Justify.SpaceBetween">
            <!--1-->
            <DisplayField Field="BasketPricesInfo!.ProductsNetAmount" />

            <!--2-->
            <MudGrid>
                <MudItem xs="6">
                    <GenericMudSelect T="string"
                                      Variant="Variant.Outlined"
                                      @bind-BoundValue="@WarrantyCostOptionsValue"
                                      Field="BasketPricesInfo?.WarrantyCostOption"
                                      Items="WarrantyCostOptions?.Select(item => item?.ToString()).ToList()" />
                </MudItem>
                <MudItem xs="6">
                    <DisplayField Field="BasketPricesInfo!.WarrantyCostAmount" />

                </MudItem>
            </MudGrid>
            <!--3-->
            <MudGrid>
                <MudItem xs="6">
                    <GenericMudSelect T="string"
                                      Variant="Variant.Outlined"
                                      @bind-BoundValue="@ShippingCostOptionValue"
                                      Field="BasketPricesInfo?.ShippingCostOption"
                                      Items="ShippingCostOptions?.Select(item => item?.ToString()).ToList()" />
                </MudItem>
                <MudItem xs="6">
                    <GenericTextField Format="C"
                                      Culture="cultureInfo"
                                      Field="BasketPricesInfo!.ShippingCostAmount"
                                      @bind-BoundValue="ShippingCostAmountValue" />
                </MudItem>
            </MudGrid>

            <!--4-->
            <DisplayField Field="BasketPricesInfo!.LogisticInfo" />

        </MudStack>
    </MudItem>

    <!--Column3-->
    <MudItem xs="3">
        <MudStack Justify="Justify.SpaceBetween">
            <!--1-->
            <DisplayField Field="BasketPricesInfo!.TotalNetAmount" />

            <!--2-->
            <DisplayField Field="BasketPricesInfo!.VatAmount" />

            <!--3-->
            <DisplayField Field="BasketPricesInfo!.TotalGrossAmount" />

            <!--4-->
            <DisplayField Field="BasketPricesInfo!.DeliveryDates" />

        </MudStack>
    </MudItem>

    <!--Column4-->
    <MudItem xs="3">
        <MudStack Justify="Justify.SpaceBetween">
            <!--1-->
            <GenericTextField Field="BasketPricesInfo?.OrderDiscountRate"
                              @bind-BoundValue="OrderDiscountRateValue" />

            <!--2-->
            <DisplayField Field="BasketPricesInfo!.DiscountAmount" />

            <!--3-->
            <DisplayField Field="BasketPricesInfo!.AdditionalSalesAmount" />

            <!--4-->
            <MudGrid>
                <MudItem xs="6">
                    <DisplayField Field="BasketPricesInfo!.TotalWeight" />

                </MudItem>
                <MudItem xs="6">
                    <DisplayField Field="BasketPricesInfo!.TotalVolume" />

                </MudItem>
            </MudGrid>
        </MudStack>
    </MudItem>
</MudGrid>

@code
{
#warning Code for testing purposes
    private CultureInfo cultureInfo = CultureInfo.CreateSpecificCulture("fr-FR");
}