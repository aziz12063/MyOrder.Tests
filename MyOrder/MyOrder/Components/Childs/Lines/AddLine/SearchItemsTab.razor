@using MyOrder.Store.BasketItemsUseCase
@using MyOrder.Shared.Dtos.BasketItems
@inherits FluxorComponentBase<SearchItemsState, FetchSearchItemsAction>

@if (State.Value.IsLoading)
{
    <HeaderElementLoadingSkeleton />
    return;
}
<FetchActionTypeCascadingValue FetchActionTypeValue="FetchActionType">
    <!--Grid-->
    <MudDataGrid T="BasketItemDto"
                 Elevation="0"
                 Bordered="true"
                 Dense="true"
                 Striped="true"
                 FixedHeader="true"
                 Height="50vh"
                 Virtualize="true"
                 Items="BasketItems"
                 SortMode="@SortMode.None"
                 QuickFilter="QuickFilter">
        <ToolBarContent>
            <FilterItems SearchTextCallback="FilterItemsCallback"
                         FilterInactiveItemsCallback="ToggleBlockedCallback" />
            <MudTooltip Text="Copier les données dans le presse-papiers">
                <MudIconButton Icon="@Icons.Material.Outlined.ContentCopy"
                               OnClick="CopyDataToClipboard" />
            </MudTooltip>
            
        </ToolBarContent>
        <Columns>

            <TemplateColumn Title="Code">
                <CellTemplate>
                    <MudTooltip Text="Ajouter cet article">
                        <MudButton Variant="Variant.Text"
                                   DropShadow="true"
                                   Color="Color.Primary"
                                   StartIcon="@Icons.Material.Filled.KeyboardDoubleArrowRight"
                                   OnClick="() => OnItemClick(context.Item)">
                            @context.Item.ItemId
                        </MudButton>
                    </MudTooltip>
                </CellTemplate>
            </TemplateColumn>

            <PropertyColumn Property="item => item.Description == null ? string.Empty : item.Description"
                            Title="Description" />

            <PropertyColumn Property="item => item.Category1 == null? string.Empty : item.Category1"
                            Title="Famille Catalogue" />

            <PropertyColumn Property="item => item.Category2 == null? string.Empty : item.Category2"
                            Title="Groupe" />

            <PropertyColumn Property="item => item.Category3 == null? string.Empty : item.Category3"
                            Title="Sous-groupe" />

            <PropertyColumn Property="item => item.MultipleQuantity == null ? 0 : item.MultipleQuantity "
                            Title="Vendu par" />

            <PropertyColumn Property="item => item.Status != null ? item.Status : null "
                            Title="Statut" />
        </Columns>
    </MudDataGrid>
</FetchActionTypeCascadingValue>